---
title: "A quick overview of `data.table`"
author: "Will Simmons"
date: "2021-12-08"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

<br>

## Resources I've found helpful

Note: I draw significantly from these resources throughout this walkthrough.

* [Introduction to `data.table`](https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html)
* [`Atrebas`'s A gentle introduction to `data.table`](https://atrebas.github.io/post/2020-06-17-datatable-introduction/)
* [Elio Campitelli's *Why I Love `data.table`](https://eliocamp.github.io/codigo-r/en/2019/07/why-i-love-data-table/)

<br>

## Walkthrough

### 1. `data.table` syntax

`data.table` syntax can be considered more *compact* than other `R` "flavors," including `dplyr`. Using `data.table` boils down to three elements: `i`, `j`, and `by`. 

```{r, eval=FALSE}

DT[i, j, by]

```

This can be translated as: "Take data.table `DT`, subset rows using `i` and manipulate columns with `j`, grouped according to `by`." (Source: [Data transformation with `data.table`: Cheat sheet](https://rdatatable.gitlab.io/data.table/).)

<br>

###  2. Create a `data.table`

<br>

First, a little setup:

```{r, setup}
library(data.table)
library(palmerpenguins)
```

<br>

#### a. From scratch

Similar to `data.frame` or `tibble`, we can manually define a `data.table`.

```{r}

# Create a data.table from scratch

test <- data.table(
  a = 1:5,
  b = letters[1:5],  # letters and LETTERS are predefined vectors in R
  c = LETTERS[1:5]
)

test

```

<br>

#### b. From an existing data object

We can also coerce an existing data object into a `data.table` using the `setDT()` function. We'll use the `penguins` dataset from the R package `palmerpenguins` as an example.

First, load the `penguins` dataset.

```{r}

penguins <- penguins

```

`penguins` is loaded as a `tibble` by default; let's change it so we can manipulate it using `data.table`.

```{r}

# Make an existing object into a data.table

penguins <- setDT(penguins)  # use setDT() to coerce to data.table
class(penguins)

```

Note: `data.table` operations won't work on non-`data.table` objects.

<br>

### 3. Manipulate a `data.table`

<br>

#### a. Subset rows in `i`

We can subset rows by logical condition (e.g., in reference to the columns in the dataset)...

```{r}

penguins[bill_length_mm >= 58]  # by condition - no need to use $ to refer to variables

```

or by row index.

```{r}

penguins[1:3]

```

<br>

#### b. Reorder rows in `i`

We'll reorder rows using `order()`.

```{r}

penguins[order(bill_length_mm)]  # similar to dplyr, puts NAs at end

```

If we want to sort in descending order, we'll use a hyphen (`-`) in front of the sorting column name.

```{r}

penguins[order(-bill_length_mm)]  # opposite order as above

```

#### c. Select column(s) in `j`

Similar to `dplyr`'s `select()`
